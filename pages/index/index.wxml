<!-- 游戏中心首页 -->
<view class="game-container">
  
  <!-- 轮播图区域 -->
  <view class="carousel-section">
    <swiper class="game-swiper" indicator-dots="true" indicator-active-color="#e64340" autoplay circular>
      <swiper-item wx:for="{{banners}}" wx:key="id">
        <image 
          mode="aspectFill" 
          bindtap="tapBanner" 
          data-item="{{ item }}" 
          src="{{item.picUrl}}" 
          class="carousel-image"
        />
      </swiper-item>
    </swiper>
  </view>

  <!-- 商品分类入口区域 -->
  <view class="entry-section">
    <view class="entry-grid">
      <!-- 动态显示商品分类 -->
      <view 
        class="entry-item" 
        wx:for="{{categories}}" 
        wx:key="id"
        bindtap="onCategoryClick"
        data-id="{{item.id}}"
        data-name="{{item.name}}"
      >
        <view class="entry-icon category-icon">
          <image 
            src="{{item.icon || '/images/default.png'}}" 
            class="category-image"
            mode="aspectFill"
          />
        </view>
        <text class="entry-title">{{item.name}}</text>
      </view>
      
      <!-- 如果分类少于2个，显示默认入口 -->
      <view class="entry-item" wx:if="{{categories.length < 2}}" bindtap="goAllCategories">
        <view class="entry-icon all-categories">
          <van-icon name="apps-o" size="80" color="#fff" />
        </view>
        <text class="entry-title">全部分类</text>
      </view>
    </view>
  </view>

  <!-- 会员充值板块 -->
  <view class="membership-section">
    <view class="section-header">
      <view class="section-title">
        <van-icon name="diamond-o" size="20" color="#e64340" />
        <text>会员充值</text>
      </view>
      <view class="refresh-btn" bindtap="refreshMembershipPackages" wx:if="{{!loading}}">
        <van-icon name="replay" size="16" color="#999" />
      </view>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-container" wx:if="{{loading}}">
      <van-loading size="24" color="#e64340">加载中...</van-loading>
    </view>
    
    <!-- 商品列表 -->
    <view class="membership-grid" wx:elif="{{membershipPackages.length > 0}}">
      <view 
        class="package-item" 
        wx:for="{{membershipPackages}}" 
        wx:key="id"
        bindtap="onPackageClick"
        data-package="{{item}}"
      >
        <!-- 左侧商品信息 -->
        <view class="package-left">
          <view class="package-title">{{item.title}}</view>
          <view class="package-description" wx:if="{{item.description}}">
            {{item.description}}
          </view>
          <view class="package-tags" wx:if="{{item.tags}}">
            <text class="tag">{{item.tags}}</text>
          </view>
        </view>
        
        <!-- 中间价格 -->
        <view class="package-center">
          <view class="price-container">
            <view class="member-price-label">¥{{item.minPrice}}</view>
          </view>
          <view class="original-price" wx:if="{{item.originalPrice && item.originalPrice != item.minPrice}}">
           ¥{{item.originalPrice}}
          </view>
          
        </view>
        
        <!-- 右侧按钮 -->
        <view class="package-right">
          <van-button 
            type="primary" 
            size="small" 
            round
            custom-style="background: linear-gradient(135deg, #e64340 0%, #ff8a80 100%); border: none;"
          >
            立即购买
          </van-button>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-container" wx:else>
      <van-empty description="暂无充值商品" />
    </view>
  </view>

</view>

<!-- 弹出编辑昵称和头像的框 -->
<login show="{{ nickPopShow }}" avatarUrl="{{ popavatarUrl }}" name="{{ popnick }}" />